import requests

# cookies = {
#     'https_waf_cookie': '62ae52ee-eb56-425fdd0da66b446df50acfe30d3d1ccf3858',
#     'SF_cookie_129': '13229536',
# }
#
# headers = {
#     'Accept': 'application/json, text/plain, */*',
#     'Accept-Language': 'zh-CN,zh;q=0.9',
#     'Cache-Control': 'no-cache',
#     'Connection': 'keep-alive',
#     'Content-Type': 'application/json;charset=UTF-8',
#     # Requests sorts cookies= alphabetically
#     # 'Cookie': 'https_waf_cookie=62ae52ee-eb56-425fdd0da66b446df50acfe30d3d1ccf3858; SF_cookie_129=13229536',
#     'Origin': 'https://xxgs.chinanpo.mca.gov.cn',
#     'Pragma': 'no-cache',
#     'Referer': 'https://xxgs.chinanpo.mca.gov.cn/gsxt/newList',
#     'Sec-Fetch-Dest': 'empty',
#     'Sec-Fetch-Mode': 'cors',
#     'Sec-Fetch-Site': 'same-origin',
#     'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36',
#     'sec-ch-ua': '"Not/A)Brand";v="99", "Google Chrome";v="115", "Chromium";v="115"',
#     'sec-ch-ua-mobile': '?0',
#     'sec-ch-ua-platform': '"Windows"',
# }
#
# json_data = {
#     'pageNo': 1,
#     'pageSize': 20,
#     'paramsValue': '律师协会',
#     'ssfw': '1',
#     'aaae0127': '',
#     'xyzk': '',
#     'aaae0129': '',
#     'aaae0105': '',
#     'aaae0123': '',
#     'aaae0114': '',
#     'aae15having': '',
#     'aaae0145': '',
#     'aaae0110': '',
#     'aaae0137': '',
#     'aaae0149': '',
#     'aaae0136': '',
#     'aaae0139': '',
#     'a': 'QnA3L2pETWE4K3ZvNjRLQ0dSWVExK3NEMTdJKzBJVGJTeHB6bGl3YTc3NncrWEMvb3JDTVdZRCt0QXZXZmJLVUdDYVNoWGk5L1dvYUtwY0thMkxHSFo1ZFZGdC9jakk1TnZBRkFpdVN2eTh1UUp2MmtIUUJ3K2o0Nnk4TVFlTENEOXlEaEdOM1BzN1lSQm5JczNlYWVFK1JyS3B6WkF5M2QvWDFaV25wSVZNPQ==',
#     'b': 'RmdyTG9EejdmcTdSSHdrL0x4UC9yV0pUTWlSODRTSEk0MERNalcxaXJEZ3BrdXNBTFBtTCsyVzk4U2dUWHRxMFB2a0xDYmt2eUlzRWpyT1ZlUitXM25TM2pRbUxLMVc4ZWJDRHBzaGh4Ym1LemNiQ2JPMkRDVFdveXZJWk5nOFNyaTZBYlkwck1Ec1BuR1E1NTdoVGpaY1k5blh3YkFiL002V3Y0N0huTk1nPQ==',
#     'c': 'UWxUakg3aDZ2MHREK3VyREJUR3I2THhqSjhXSEJ5SHhmUCs1WERmU1Ezc1c3TXpnOTgwVkh3NWwvWTdPeUVMZUgray9KQjJLWTZCQm1mWmwwSGZQODNDeWhhOXliTlR5VHRxVjFqQzJSWGNyM3Jyd05QRjA1eXhWaC9xdWV2ckhtV25rTFI5N1loR0t0NVVmOTRnN3R2MS9GMTlSZkZ2QWlKMUFYeVhjVE9nPQ==',
# }
#
# ids = []
# for i in range(1, 23):
#     json_data["pageNo"] = i
#     response = requests.post('https://xxgs.chinanpo.mca.gov.cn/gsxt/PlatformSHZZFRKGSXT/biz/ma/shzzgsxt/a/gridQuery.html', cookies=cookies, headers=headers, json=json_data)
#     if response.status_code == 200:
#         query_json = response.json()
#         if query_json["code"] == 200 and query_json["result"] and query_json["result"]["data"]:
#             for i in query_json["result"]["data"]:
#                 ids.append(i["aaae0102"])
#         else:
#             print(response.json())
# print(ids)
headers = {
    'Accept': 'application/json, text/plain, */*',
    'Accept-Language': 'zh-CN,zh;q=0.9',
    'Cache-Control': 'no-cache',
    'Connection': 'keep-alive',
    'Content-Type': 'application/json;charset=UTF-8',
    # Requests sorts cookies= alphabetically
    # 'Cookie': 'https_waf_cookie=62ae52ee-eb56-425fdd0da66b446df50acfe30d3d1ccf3858; SF_cookie_129=13229536',
    'Origin': 'https://xxgs.chinanpo.mca.gov.cn',
    'Pragma': 'no-cache',
    'Referer': 'https://xxgs.chinanpo.mca.gov.cn/gsxt/newDetails?b=eyJpZCI6IjUxMTMwMTAwNTA2NDEyOTc3RSJ9',
    'Sec-Fetch-Dest': 'empty',
    'Sec-Fetch-Mode': 'cors',
    'Sec-Fetch-Site': 'same-origin',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36',
    'sec-ch-ua': '"Not/A)Brand";v="99", "Google Chrome";v="115", "Chromium";v="115"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Windows"',
}

json_data = {
    'id': '51130100506412977E',
}
import pandas as pd
datas = []
ids = ['511000004000008271', '5111000050030510XN', '51110101500502453F', '511101025005858424', '511101055695132733', '51110106500641189N', '511101075006657466', '511101085674976441', '51110109500716574P', '51110111500731619X', '51110112500800071U', '511101135007742136', '51110114500746335R', '51110115500814430B', '51110116MJ0372137C', '51110117MJ03621588', '51110118MJ0385632K', '51110119MJ03922509', '51120000500920233X', '511300005064049695', '51130100506412977E', '51130131MJ0764878B', '511302003081253606', '511303007777302485', '51130400506475994T', '51130402MJ08813614', '51130425MJ0827859F', '51130500A082090200', '51130600780805351U', '51130682MJ0824340C', '511307007666391741', '51130800MJ0756384H', '51130900777706264X', '51131000059443295C', '51131100348011288K', '51133100MJY9947986', '51140000506100033U', '511401007810030000', '51140200MJY075062D', '511403007485784866', '51140400506103955H', '51140500759840590K', '51140600770145441F', '51140700506314744M', '51140800330545249U', '51140900757283030E', '51141000506339079C', '51141100356673599Y', '511500005026987605', '51150100502709669L', '51150200502723575W', '51150300MJ23401201', '51150400502741706F', '51150500502774671K', '511506005612494398', '51150800MJY108725F', '511509007722100915', '5115220050276780XM', '51152500329119496H', '51152900502832771U', '51150781502758364W', '51210000318942591C', '51210000463000939P', '51210100508206413A', '51210200508258037C', '51210300507501242N', '512104005075500521', '51210500507601075L', '51210600A44500421K', '512107007683349059', '51210803507751137G', '51210900507800736X', '5121100050785112XX', '51211100508050068T', '512112003189942526', '512113005079505154', '51211400A48000205G', '51220000696113168X', '51220000508315011F', '51220100509105585X', '51220200508306174E', '51220300782648564G', '512204005083576176', '51220500778700657M', '5122060050840601X7', '51220700508341148C', '51220800508375671F', '512224005083855462', '512300004140019004', '51230100507128169E', '51230102MJY2169375', '5123020050530478X2', '51230300692622424N', '51230400681414750W', '51230500MJ461405XT', '512306005053982614', '51230700414206623U', '51230800336431197M', '51230900777869071P', '51231000505610314B', '512311005513260908', '51231200556143496A', '512327007726152088', '513100005017721488', '51320000509195912B', '513200005091952779', '5132010051115831X9', '5132020050922244XN', '5132020550931386XR', '51320281MJ604250X5', '513202825093641063', '51320300509382670H', '513204005096104774', '51320481MJ6455064K', '5132050050977034XM', '51320505509845962X', '51320506MJ6660156Q', '51320507MJ6680026X', '51320508509794405W', '513205095099918204', '51320581509862631J', '51320582509887900F', '51320583509929445P', '513205855099130484', '51320591MJ68800609', '51320600510006277H', '51320602510031632L', '51320684510148283U', '513206235101202130', '513206815101648659', '5132068251008120X1', '51320621510064178C', '51320700510190246D', '51320800510334596C', '513209005105867853', '51321000510763702F', '51321100511026878Y', '51321181MJ78704467', '51321182MJ790823XN', '51321183MJ7890527A', '513212005108231974', '513212025108412133', '51321283MJ80527797', '513213006789553888', '51321322MJ8170871H', '51321323MJ82054567', '51321324MJ8220808Q', '51330000501876473L', '513300005018753585', '51330100501903443D', '51330200MJ89364863', '51330300502106438D', '513304005022039329', '513305005022734201', '51330600502305146L', '51330700779383235B', '51330782059575810W', '51330800761344801P', '51330900502486135P', '513310005026064677', '513311006831030750', '51340000675874857X', '51340000740888594J', '5134010074309647XL', '513402005113885532', '51340300666229346Y', '513404007810521015', '51340500777397932U', '51340600511487295B', '51340700595739145E', '51340800511523049Q', '51340826087571104K', '51341000B12324280U', '51341100680831907E', '513412007981157036', '51341300793596966N', '51341500756818152Q', '51341600756833360F', '513417007790989798', '513418005117063631', '513418225970848401', '51350000512157124P', '51350100B212063667', '51350200B34601381R', '51350300B23482436N', '51350400B26461227E', '51350500B2648260X3', '51350600513129571N', '51350700513134346G', '51350800513508440Q', '51350900660375342W', '51360000K191808017', '513601005138058086', '51360200MJC810119U', '51360300751104089P', '51360400573616822B', '51360500MJC942410Q', '51360600563814462P', '51360700MJC979336U', '513608005143256113', '51360900MJD1396973', '51361000775865595A', '51361100763394749N', '51370000MJD600885H', '51371200MJE7538912', '51370100MJD6800453', '51370200MJD8005296', '51370202MJD874026G', '51370300MJE1006471', '51370400MJE212809C', '51370481MJE23483XM', '51370500MJE258639K', '51370600MJE301799X', '51370602MJE314856G', '51370612MJE334654X', '51370613MJE329601A', '51370681MJE359923A', '51370683MJE370794L', '51370685MJE367210B', '51370690MJE3818132', '51370700MJE3895083', '51370800MJE489488D', '51370811MJE503008M', '51370900MJE569832L', '51371000MJE634075R', '51371100MJE693067B', '51371300MJE774895A', '51371302MJE795741N', '51371400MJE895523A', '51371402MJE910607P', '51371500MJE952938L', '51371600MJE9902056', '51371700MJF040172U', '51410000514558693C', '51410100725815055K', '51410200753859100F', '51410300MJF900726A', '51410300514755451M', '51410400514827021T', '51410500514919428M', '51410600758383500Q', '5141070031721666XL', '51410800753893050H', '51410900777989583J', '51411000670061080K', '51411100358945332T', '51411200742517842G', '51411300725837975D', '51411400317606860M', '514115007751243248', '51411600772174502L', '51411700766219372L', '514190017751215108', '51420000MJH200272M', '514201005227234686', '51420200MJH4333751', '514203005036020545', '5142050050360755XD', '51420600777552920A', '51420700MJH733722T', '51420800665451009P', '51420900503670428U', '51421000553910151R', '514211007417979347', '51421200747693124K', '51421300503641993D', '5142280006351771XM', '51429004MJJ145326J', '514300000682056788', '514300005014255762', '51430100501436486H', '51430200501460355N', '514303005014761706', '51430400501492568C', '5143050050152200XC', '51430600501553885B', '514307005015794603', '51430800689506422U', '5143090077449020X9', '514310005016527447', '514311005016817991', '51431100093073670T', '514312005017143274', '51431300768041643X', '51433100501749247F', '51440000C03634356A', '51440100C14906097W', '514402007578591168', '51440300502675702F', '51440400C03686033P', '514405005153694647', '51440600C03731367A', '514407007123654382', '51440800C03787854Q', '514409005153910127', '5144120075107414XG', '514413005154130151', '51441400714761063M', '51441500776949782R', '514416007361531226', '51441700725965029X', '51441800707511875K', '514419007077341634', '51442000C03890739P', '51445100515410279G', '51445200059925024N', '514453007536627895', '514500005071572342', '514501007451109920', '51450200775971531M', '51450300768907304B', '51450400794300733J', '51450500MJN439559W', '51450600052739173D', '51450700782110094P', '514508005794091467', '51450900589807068W', '51451000782109309G', '51451100791334751W', '51451200779113833D', '51451300782149810G', '5145140178212906X6', '51460000503862980K', '51500000504023898F', '51510000504059209X', '51510100504106829D', '51510300C384840795', '51510400C387133456', '51510500793958357F', '51510600504444828C', '515107007496483272', '515108003562977060', '51510900673533581J', '5151100050459341X5', '51511100779831536R', '51511300795829807J', '51511400742290879X', '51511500504844813D', '51511600767295289E', '515117007597079761', '51511800775826908B', '51511900MJQ0599576', '51512000740049555Y', '51513200694827503Q', '51513300669572916J', '51513400687928816Q', '515200005175561753', '51520100517601116W', '51520200C58025013X', '515203005176160512', '515204007897757507', '515205007411374854', '51520600662958090E', '51522300560949054P', '51522600517675203X', '5152270056091437XH', '51530000518356079Y', '51530100518431200B', '515303005185652841', '51530400518670455P', '515305005189750640', '5153060074829108X2', '515307007755473006', '51530800799898148F', '515309005191250616', '51532300518615069P', '515325006885913978', '5153260074828092XQ', '5153280067658232XM', '515329007785821361', '515331007452995618', '5153330079028887XP', '51533400668278731L', '515400005191565389', '51540100MJY0555633', '516100000161026188', '51610100520955767U', '51610200081743024A', '516103007700114862', '51610400MJU51534XB', '51610500305467795T', '51610581338580217Y', '516106007353824847', '516107006715465142', '51610800305754145D', '51610900305701852M', '5161100066411705XM', '516200005210395417', '516201007202152969', '51620200561148072N', '51620300665436693Q', '516204007788506121', '51620500085767461L', '51620600720281154C', '51620700767722308D', '51620800794894930R', '5162090078404924XQ', '516210007948808541', '51621100325332011G', '51621200690399230J', '51622900MJW733009B', '51623000082390160K', '51620100MJY597426B', '51630000521836524H', '51630100521885713D', '51630200MJW990208Q', '51632800MJX002136F', '51640000MJX150147G', '51640100MJX2210133', '51640200MJX290289C', '51640300MJX3157065', '51640401MJX350296G', '51640500MJX376058Q', '51650102505261978C', '5165020076113939X0', '516504007846530415', '516522007876482649', '51652300MJX503002W', '51652700757697284E', '51652800MJX539603E', '5165290076113488X4', '51653000MJX5375017', '51653100770373102C', '5165320077348019XM', '516540027637652631', '516542007817868932', '51654300MJX5896438', '51660000751669434X', '51660100MJY323900B', '516608007637997895']
for i in ids:
    json_data["id"] = i
    response = requests.post('https://xxgs.chinanpo.mca.gov.cn/gsxt/PlatformSHZZFRKGSXT/biz/ma/shzzgsxt/a/getAae01CertificateInfo.html', headers=headers, json=json_data)
    if response.status_code == 200:
        query_json = response.json()
        if query_json["code"] == 200 and query_json["result"]:
            d = {}
            d["统一社会信用代码"] = query_json["result"]["aaae0102"]
            d["社会组织名称"] = query_json["result"]["aaae0103"]
            d["社会组织类型"] = "社会团体"
            d["业务主管单位"] = query_json["result"]["aaae0109"]
            d["证书有效期"] = f'{query_json["result"]["aaae0703"]}至{query_json["result"]["aaae0704"]}'
            d["登记管理机关"] = query_json["result"]["aaae0107"]
            d["法定代表人"] = query_json["result"]["aaae0113"]
            d["成立登记日期"] = query_json["result"]["aaae0123"]
            d["注册资金"] = query_json["result"]["aaae0129"]
            d["业务范围"] = query_json["result"]["aaae0122"]
            d["住所"] = query_json["result"]["aaae0116"]
            datas.append(d)
        else:
            print(response.json())
# 创建DataFrame
df = pd.DataFrame(datas)

# 将DataFrame保存到Excel文件
excel_filename = '律师协会.xlsx'
df.to_excel(excel_filename, index=False)
print(datas)
